---
title: Листинги кода
description: Оформление исходного кода и распечаток программ.
iconLocal: Code
---

Листинги программного кода в отчёте по ГОСТ называются «распечатками программ» и рассматриваются
как разновидность иллюстраций. Они должны быть чёткими и пригодными для воспроизведения.

В шаблоне `modern-g7-32` блоки кода автоматически оформляются моноширинным шрифтом и, что важно,
**поддерживают перенос на следующую страницу**, если код слишком длинный.

## Быстрый старт

Для вставки кода используйте стандартные блоки Typst (три обратных апострофа), обёрнутые в функцию
`#figure`. Это обеспечит нумерацию и добавит подпись.

<TypstRender
  code={`
#figure(
  \`\`\`rust
  fn main() {
      println!("Hello, World!");
  }
  \`\`\`,
  caption: [Листинг программы на языке Rust]
) <listing-example>
`}
  image="code-example-simple.png"
/>

## Автоматизация и логика шаблона

Шаблон настраивает блоки кода следующим образом:

1.  **Многостраничность**: В отличие от обычных рисунков, блоки кода (`kind: raw`) по умолчанию
    сделаны «разбиваемыми» (`breakable: true`). Если листинг не помещается на одной странице, 
    он корректно перенесётся на следующую.
2.  **Нумерация**: Листинги нумеруются в одном ряду с рисунками (как «Рисунок 1») или отдельно, 
    в зависимости от настроек. По умолчанию в ГОСТ они часто идут как иллюстрации ([6.5.1](#6.5.1)).
3.  **Подписи**: Разделитель в подписи заменяется на длинное тире («Рисунок 1 — Наименование»), 
    согласно [6.5.7](#6.5.7).

## Чтение из внешних файлов

Для больших проектов удобнее хранить код в отдельных файлах и подключать их в отчёт автоматически. 
Это гарантирует, что в документе всегда будет актуальная версия кода.

<TypstRender
  code={`
#figure(
  raw(read("src/main.py"), lang: "python", block: true),
  caption: [Исходный код модуля main.py]
) <listing-file>
`}
  image="code-example-read.png"
/>

## Параметры функции raw

Функция `raw` отвечает за отрисовку кода. Основные параметры:

<TypeTable
  type={{
    text: {
      description: "Текст программного кода",
      type: "string",
    },
    lang: {
      description: "Язык программирования (для подсветки синтаксиса)",
      type: "string | none",
      default: "none"
    },
    block: {
      description: "Отображать ли код отдельным блоком",
      type: "boolean",
      default: "false"
    }
  }}
/>

## Продвинутое использование

### Подсветка синтаксиса
Typst поддерживает подсветку для сотен языков. Просто укажите название языка после первых трёх
апострофов. Чтобы изменить тему подсветки, вы можете использовать стандартную команду Typst:
`#set raw(theme: "название-темы")`.

### Код в приложениях
Если вы выносите листинги в [приложение](./appendixes.mdx), их нумерация автоматически изменится 
на буквенно-цифровую (например, «Рисунок А.5»), как требует [6.5.5](#6.5.5).

## Требования ГОСТ 7.32-2017

### Качество и вид
<GostQuote page={11} id="6.1.2">
6.1.2 Вне зависимости от способа выполнения отчета качество напечатанного текста и оформления... 
распечаток программ должно удовлетворять требованию их четкого воспроизведения.
</GostQuote>

### Место в отчёте
<GostQuote page={12} id="6.5.1">
6.5.1 Иллюстрации (чертежи, графики, схемы, компьютерные распечатки... фотоснимки) следует располагать 
в отчете непосредственно после текста отчета, где они упоминаются впервые, или на следующей странице.
</GostQuote>

### Нумерация и подписи
<GostQuote page={12} id="6.5.4">
6.5.4 Иллюстрации... следует нумеровать арабскими цифрами сквозной нумерацией.
</GostQuote>

<GostQuote page={13} id="6.5.7">
6.5.7 Слово «Рисунок», его номер и через тире наименование помещают... в центре под рисунком 
без точки в конце.
</GostQuote>